# 역할, 책임, 협력

객체지향 설계의 핵심은 협력을 구성하기 위해 적절한 객체를 찾고, 책임을 할당하는 과정이다.   

## 협력
애플리케이션을 제어하는 것은 만능 객체에 의한 것이 아닌, 다양한 객체들 간의 메시지를 주고 받는 협력에서 이루어진다.   
객체들은 자신의 역할을 수행하며 상호작용을 하는데 이를 협력이라 부르고, 이 협력을 위해 자신의 로직을 수행하는 것을 책임이라 하며, 책임들이 모여 객체가 수행하는 것을 역할이라 한다.   

객체들이 협력하는 방법은 메시지를 주고 받는 것이다.   
그리고 이 메시지를 주고 받기 위해 객체는 메서드를 구성하고, 자율적으로 처리한다.  
자율적으로 메시지를 처리하기 위해서는 스스로가 정보에 대해 잘 알고 있어야 한다.   
즉, 협력에 참여하기 위해서는 스스로의 정보를 잘 알고, 잘 처리할 수 있는 객체들이 캡슐화를 통해 메시지를 제공하는 것이 중요하다.  

가령 Movie는 자신이 영화 요금을 알고 있기 때문에 영화 요금을 계산한다는 행동을 구성할 수 있다.   
그리고 Screening과의 협력을 통해서 영화 요금을 계산할 수 있다.
```
Screening -> (calculateMovieFee(screening) -> Movie 
```

이렇듯 협력은 객체의 상태라는 정보와 객체의 행동을 통해서 문맥을 제공한다.

## 책임
책임은 객체가 아는 정보, 수행 가능한 행동을 정의한 것이다.    
가장 좋은 것은 객체 스스로가 자신이 알고있는 정보를 가지고, 행동을 정의하고 책임을 할당받는 것이다.

가령 영화 예매 시스템을 예로 들면 다음과 같다.
* 영화를 예매하는 것은 시스템이 제공할 책임이고, 이를 협력해야할 것으로 정한다.
* 예매하기 위한 정보는 상영 시간과 기본 요금인데 이를 잘 알고 있는 것은 Screening이고, Screening에게 책임을 할당한다.
* 영화 예매를 위해선 요금 계산이 필요하고, 가격과 할인 정책을 잘 알고 있는 것은 Movie이기에 Movie에게 책임을 할당한다.

```
Screening::reserve -> Movie::calculateMovieFee
```
객체지향은 협력에 필요한 메시지(행동)를 정의하고, 어떤 객체에게 책임을 할당한 것인지에 대한 반복이다.   
먼저 메시지(행동)를 정의하는 이유는 다음과 같다.
* 객체는 최소한의 인터페이스를 가질 수 있다.
* 객체는 내부의 구현을 노출하는 것이 아닌 추상적인 인터페이스를 가짐으로써 외부와 어떻게 소통할 것인지 정할 수 있다.

가령 예매하라라는 메시지를 먼저 정의하고, 이 메시지가 가장 적합한 Screening을 고르고, 가격 계산.. 과 같은 순으로 협력을 구성할 수 있었다.

## 역할
역할은 유연하고 재사용 가능한 협력을 얻을 수 있다.   

가령, 영화 예매에서 할인 요금 계산 예제를 보면 다음과 같다.
```
* 가격 기반 할인 정책
Screening::reserve -> Movie::calculateMovieFee -> AmountDiscountPolicy::calculateDiscountAmount

* 비율 기반 할인 정책
Screening::reserve -> Movie::calculateMovieFee -> PercentDiscountPolicy::calculateDiscountAmount
```
이 협력을 개별적으로 구현하면, 중복된 코드를 생산해내고 이를 피하기 위해 어떤 책임을 수행할지에 초점을 맞춰야 한다.  
할인 요금을 계산한다는 책임을 뽑을 수 있고, 이 책임을 수행하는 객체를 추상화하여 역할로 만들 수 있다.

추상화를 통해 얻을 수 있는 장점은 다음과 같다.
1. 주요 정책을 상위 수준에서 단순화 할 수 있다.
   * 세부 사항에 의존하지 않고, 상위 수준에서 핵심만 표현 가능하다.
2. 설계가 유연해진다.
   * 역할이라는 추상화를 통해 협력이라는 구현체를 얼마든지 갈아 끼우므로 유연한 설계가 가능하다.
